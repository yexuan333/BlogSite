+++
title = 'CPP函数'
date = 2023-12-31T23:55:23+08:00
draft = false
+++
##### 定义函数
```cpp
// 无返回值函数
void print(std::string text){
    std::cout << text << std::endl;
}
// 有返回值函数
int add(int a, int b){
    return a + b;
}
```
##### 函数原型
###### 什么是原型
函数原型是一条语句，以`;`结束，一般放在头文件中，如:
```cpp
void add(int a,int b);
```
###### 为什么需要原型
C++的底层编译为了与C兼容，继承了C语言编译的大部分特点，采用类似**单遍编译**的做法，编译器按顺序处理源代码文件。当编译器遇到一个函数调用时，它必须已经知道这个函数的签名（即函数原型），否则会产生编译错误。这就是为什么 C++ 需要在调用函数之前声明函数原型的原因。
##### 函数参数与传递
###### 按值传递
按值传递不会修改实参的值。用于基本数据类型或当需要保护实参不被修改时。对于大型对象或结构，复制可能导致性能开销。
```cpp
void function(int param) {
    param = 20; // 只修改局部副本
}
```
###### 按引用传递
形参成为实参的一个别名，指向同一内存位置。在函数内对参数的修改会影响到外部的实参。
```cpp
void function(int& param) {
    param = 20; // 直接修改实参
}
```
###### 按常量引用传递
结合了按值传递和按引用传递的优点。形参是实参的常量引用，保护实参不被修改。
```cpp
void function(const int& param) {
    // param = 20; // 错误：不能修改 const 引用
}
```
###### 按指针传递
传递给函数的是指针，即变量的地址。函数可以通过指针间接修改实参。
```cpp
void function(int* param) {
    *param = 20; // 修改指针指向的值
}
```
###### 按指针的指针传递
传递指针的地址，即指向指针的指针。可以修改指针本身及其指向的值。
```cpp
void function(int** param) {
    int a = 10;
    *param = &a; // 修改指向的指针,也修改了指向的值
    **param = 20; // 修改指向的指针指向的值
}
```
###### 按右值引用传递
右值引用是 C++11 引入的一种引用类型，它绑定到临时对象（即右值）上。使用 `&&` 操作符表示右值引用。右值引用允许函数接收一个即将销毁的临时对象。当函数需要接收一个临时对象并希望避免复制或修改该对象时使用。
```cpp
void function(int&& param) {
    // 使用右值引用
}
function(1); // 1就是右值
```
###### 变量遮蔽
如果在函数外有一个变量 x，然后在函数内部重新声明了一个同名的变量 x，这种行为称为“变量遮蔽”或“局部遮蔽”
```cpp
int x = 10; // 全局变量

void myFunction() {
    int x = 20; // 局部变量，遮蔽了全局变量 x
    // 在这个作用域内，x 指的是局部变量，会在退出函数的时候释放这个变量
}

int main() {
    myFunction();
    // 在这个位置，x 指的是全局变量
    return 0;
}
```